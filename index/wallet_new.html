<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TON Wallet</title>

    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
   
</head>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #eeeeee;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
}

.wallet {
    width: 420px; /* M·ªü r·ªông giao di·ªán */
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    padding: 20px;
}

.wallet-card {
    background: linear-gradient(135deg, #007bff, #00c3ff);
    color: white;
    border-radius: 15px;
    padding: 25px;
    text-align: center;
}

.wallet-header {
    display: flex;
    justify-content: space-between;
    font-weight: bold;
    margin-bottom: 10px;
    font-size: 16px;

}

.wallet-address {
    font-size: 14px;
    background: rgba(255, 255, 255, 0.2);
    padding: 5px 10px;
    border-radius: 10px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 160px; /* Gi·ªõi h·∫°n ƒë·ªô d√†i ƒë·ªãa ch·ªâ */

}

.wallet-balance {
    font-size: 28px;
    font-weight: bold;
    margin-top: 5px;
}

.wallet-usdt-value {
    font-size: 14px;
    opacity: 0.8;
}

.wallet-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 15px;
}

.wallet-actions button {
    flex: 1;
    border: none;
    padding: 12px;
    margin: 5px;
    border-radius: 10px;
    font-size: 16px;
    cursor: pointer;
}

.receive {
    background: #4caf50;
    color: white;
}

.send {
    background: #ff5722;
    color: white;
}

.tokens {
    margin-top: 15px;
}

.token {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px;
    background: #f9f9f9;
    border-radius: 10px;
    margin-bottom: 10px;
}

.token img {
    width: 40px;
    height: 40px;
    margin-right: 15px;
    border-radius: 25px;
}

.token-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
}

.token span {
    font-size: 16px;
}

.token-info i {
    margin-left: 5px;
    color: red;
    cursor: pointer;
}

.token-value {
    font-size: 16px;
    font-weight: bold;
}




/* ƒê·∫£m b·∫£o h√¨nh ·∫£nh v√≠ ƒë∆∞·ª£c hi·ªÉn th·ªã trong th·∫ª a */
#wallet-link {
    display: inline-block; /* Gi·ªØ cho th·∫ª a kh√¥ng b·ªã chi·∫øm to√†n b·ªô kh√¥ng gian */
    width: 40px; /* ƒê·∫∑t k√≠ch th∆∞·ªõc h√¨nh ·∫£nh v√≠ */
    height: 40px; /* ƒê·∫∑t chi·ªÅu cao h√¨nh ·∫£nh v√≠ */
    overflow: hidden; /* ·∫®n ph·∫ßn h√¨nh ·∫£nh v∆∞·ª£t ngo√†i gi·ªõi h·∫°n */
    border-radius: 50%; /* T·∫°o h√¨nh tr√≤n cho ·∫£nh */
}

/* CƒÉn ch·ªânh h√¨nh ·∫£nh b√™n trong th·∫ª a */
#wallet-link img {
    width: 100%; /* ƒê·∫£m b·∫£o h√¨nh ·∫£nh chi·∫øm h·∫øt di·ªán t√≠ch c·ªßa th·∫ª a */
    height: 100%; /* ƒê·∫£m b·∫£o h√¨nh ·∫£nh kh√¥ng b·ªã m√©o */
    object-fit: cover; /* Gi·ªØ t·ª∑ l·ªá h√¨nh ·∫£nh ƒë√∫ng m√† kh√¥ng b·ªã k√©o d√£n */
}




.footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #212121;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    padding: 10px 0;
    border-top: 1px solid #333;
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.5);
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
}
.footer-item {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-decoration: none;
    color: #ccc;
    font-size: 14px;
    padding: 5px 10px;
    transition: background-color 0.3s, color 0.3s;
    border-radius: 5px; /* Bo g√≥c cho m·ª•c */
}
.footer-item img {
    width: 24px;
    height: 24px;
    margin-bottom: 4px;
}
.footer-itemm img {
    width: 45px;
    height: 45px;
    margin-bottom: 4px;
}
.footer-item:hover {
    color: #fff;
}

.new-badge {
    position: absolute;
    top: 5px;
    right: 5px;
    background-color: red;
    color: white;
    padding: 1.5px 3.25px;
    border-radius: 3px;
    font-size: 7px;
    font-weight: bold;
    z-index: 1;
}


/* Toast container */
#toast {
    visibility: hidden; /* ·∫®n toast m·∫∑c ƒë·ªãnh */
    max-width: 50%;
    margin: 0 auto;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 5px;
    padding: 16px;
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 17px;
    z-index: 9999;
    transition: opacity 0.5s ease, bottom 0.5s ease;
}

/* Khi toast hi·ªÉn th·ªã */
#toast.show {
    visibility: visible;
    opacity: 1;
    bottom: 50px;  /* ƒê∆∞a toast l√™n m·ªôt ch√∫t */
}

/* N·ªôi dung trong toast */
#toast-message {
    font-weight: bold;
    line-height: 1.5;
}

/* Hi·ªáu ·ª©ng chuy·ªÉn ƒë·ªông khi toast xu·∫•t hi·ªán */
@keyframes fadeIn {
    0% { opacity: 0; }
    100% { opacity: 1; }
}

/* Hi·ªáu ·ª©ng chuy·ªÉn ƒë·ªông khi toast ·∫©n */
@keyframes fadeOut {
    0% { opacity: 1; }
    100% { opacity: 0; }
}

/* Thi·∫øt l·∫≠p ki·ªÉu d√°ng c·ªßa th√¥ng b√°o */
.notification {
    position: fixed;
    top: -100px;  /* B·∫Øt ƒë·∫ßu b√™n ngo√†i m√†n h√¨nh */
    left: 50%;
    transform: translateX(-50%);
    background-color: #4caf50;
    color: white;
    padding: 15px;
    font-size: 16px;
    border-radius: 5px;
    z-index: 9999;
    transition: top 0.5s ease-in-out;
}

/* C·∫•u h√¨nh cho n√∫t Swap */
button.swap {
    background-color: #4caf50;  /* M√†u n·ªÅn xanh l√° */
    color: white;  /* M√†u ch·ªØ tr·∫Øng */
    padding: 10px 20px;
    font-size: 16px;
    border: none;

    cursor: pointer;
    transition: background-color 0.3s;
}

/* Thay ƒë·ªïi m√†u s·∫Øc khi di chu·ªôt qua n√∫t Swap */
button.swap:hover {
    background-color: #45a049;  /* M√†u n·ªÅn khi hover */
}




.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    border-radius: 10px;
    width: 300px;
    text-align: center;
    color:#333;
}

.modal-content input {
    width: 90%;
    padding: 8px;
    margin: 10px 0;
    border: 1px solid #ccc;
    border-radius: 5px;
}

.modal-content button {
    background: #0084ff;
    color: rgb(255, 255, 255);
    padding: 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.close {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 20px;
    cursor: pointer;
}



.slider-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 5px;
}

.slider-labels span {
    cursor: pointer;
    font-size: 14px;
    color: #007bff;
}
.slider-labels span:hover {
    text-decoration: underline;
}














/* C·∫•u tr√∫c container */
.task-container {
    width: 100%;
    padding: 10px;
    box-sizing: border-box;
}

/* Giao di·ªán cho task */
.task {
    display: grid;
    grid-template-columns: 60px 1fr 120px; /* 3 c·ªôt: ·∫£nh, th√¥ng tin nhi·ªám v·ª•, h√†nh ƒë·ªông */
    align-items: center;
    padding: 15px 20px;
    margin: 10px 0;
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #f9f9f9;
    width: 100%;
    box-sizing: border-box;
}

/* C·ªôt ·∫£nh */
.task-image-container {
    display: flex;
    justify-content: center;
    align-items: center;
}

.task-image {
    width: 50px;
    height: 50px;
    border-radius: 50%;
}

/* C·ªôt th√¥ng tin nhi·ªám v·ª• */
.task-info-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding-left: 10px;
}

.task-info-container h3 {
    font-size: 16px;
    margin: 0;
    font-weight: bold;
    color: #333;
}

.task-info-container p {
    font-size: 14px;
    color: #888;
    margin: 5px 0;
}

/* C·ªôt h√†nh ƒë·ªông */
.task-actions-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-end;
}

/* N√∫t Check-in / Claim */
button {
    padding: 8px 20px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.3s ease;
    width: 100%; /* ƒê·∫∑t chi·ªÅu r·ªông c·ªßa n√∫t */
}

button:disabled {
    background-color: #ddd;
    cursor: not-allowed;
}

/* Hi·ªáu ·ª©ng hover cho button */
button:hover {
    background-color: #45a049;
}

/* ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c */
.countdown {
    font-size: 12px;
    color: #666;
    margin-top: 5px;
}

</style>
<body>
    <div class="wallet">
        <div class="wallet-card">
            <div class="wallet-header">
                <span>TON Wallet</span>
                <div id="ton-connect"></div>
                <!-- Thay th·∫ø ƒë·ªãa ch·ªâ v√≠ b·∫±ng h√¨nh ·∫£nh -->
                <a id="wallet-link" class="wallet-address" href="#" target="_blank">
                    <img src="/logo-coin/wallet.png" alt="Wallet" id="wallet-image" />
                </a>
            </div>
            <div id="wallet-balance" class="wallet-balance">$0.00</div>
            <div id="wallet-usdt-value" class="wallet-usdt-value">‚âà 0 USDT</div>
            <div class="wallet-actions">
                <button class="receive" onclick="showComingSoon()">Receive</button>
                <button class="send" onclick="sendTransaction()">Buy</button>
                <button class="mint-bmc" id="mint-bmc" onclick="mintBMC()">Mint</button>
                <button class="withdraw" onclick="showWithdrawForm()">Withdraw</button>
            </div>
            
<!-- Form nh·∫≠p ƒë·ªãa ch·ªâ v√† s·ªë l∆∞·ª£ng r√∫t -->
<div id="withdraw-form" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeWithdrawForm()">&times;</span>
        <h2>Withdraw BMC</h2>
        <p>Available: <span id="available-bmc">0</span> BMC</p>
        <input type="text" id="withdraw-address" placeholder="Enter wallet address">
        
        <input type="number" id="withdraw-amount" min="1" placeholder="Enter amount">
        
        <!-- Thanh k√©o ch·ªçn s·ªë l∆∞·ª£ng -->
        <input type="range" id="withdraw-slider" min="0" max="100" step="25" value="0" onchange="updateWithdrawAmount()">
        <div class="slider-labels">
            <span onclick="setSliderValue(0)">0%</span>
            <span onclick="setSliderValue(25)">25%</span>
            <span onclick="setSliderValue(50)">50%</span>
            <span onclick="setSliderValue(100)">100%</span>
            <span onclick="setSliderValue('max')">MAX</span>
        </div>

        <button onclick="withdrawBMC()">Confirm Withdraw</button>
    </div>
</div>















<div class="task-container">
    <div class="task">
        <div class="task-image-container">
            <img src="task.png" alt="Task Image" class="task-image">
        </div>
        <div class="task-info-container">
            <h3 id="task-name">Check-in</h3>
            <p id="task-bmc">+100 BMC</p>
        </div>
        <div class="task-actions-container">
            <button id="check-in-btn" onclick="checkIn()">Check-in</button>
            <div class="countdown" id="countdown-timer">Reset 00:00 UTC</div>
        </div>
    </div>
</div>


















            
            
            <div id="notification" class="notification" style="display: none;">
                üöÄ Coming Soon! T√≠nh nƒÉng n√†y ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn.
            </div>
        </div>
        <div class="tokens">
            <div class="token">
                <img src="/logo-coin/ton.jpg" alt="TON">
                <div class="token-info">
                    <span>TON</span>
                    <span id="ton-balance">0 TON</span>
                </div>
                <div class="token-value" id="ton-value">$0.00</div>
            </div>
            <div class="token">
                <img src="/logo-coin/bmlogo.jpg" alt="BMC">
                <div class="token-info">
                    <span>BMC</span>
                    <span id="token-balance">Loading...</span> <!-- Tr·∫°ng th√°i Loading ban ƒë·∫ßu -->
                </div>
                <div class="token-value" id="bmc-value">$0.00</div> <!-- C·∫≠p nh·∫≠t gi√° tr·ªã BMC -->
            </div>
            
            
        </div>

    </div>

    <!-- Toast notification -->
<div id="toast" class="toast">
    <span id="toast-message"></span>
</div>






<div class="footer">
    <a href="/index/main.html" class="footer-item" onclick="setActive(this)">
    <div class="img-wrapper">
        <img src="/logo-coin/home_.png" alt="Home">

    </div>
    <span>Home</span>
</a>
<a href="/swap/index.html" class="footer-item" onclick="setActive(this)">
    <div class="img-wrapper">
        <img src="/logo-coin/swap_.png" alt="MuaCoin">
    </div>
    <span>Swap</span>
</a> 



<a href="/index/wallet_new.html" class="footer-item" onclick="setActive(this)">
    <div class="img-wrapper">
        <img src="/logo-coin/wallet_.png" alt="MuaCoin">
    </div>
    <span>Wallet</span>
</a>
</div>

<script>
   const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
    manifestUrl: 'https://bmasshd.click/tonconnect-manifest.json',
    buttonRootId: 'ton-connect'
});

async function fetchWalletData(wallet) {
    if (!wallet) return;

    const walletAddress = wallet.account.address.toString();
    let displayName = walletAddress.slice(0, 6) + '...' + walletAddress.slice(-4); // M·∫∑c ƒë·ªãnh r√∫t g·ªçn

    try {
        // Chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ th√†nh ki·ªÉu IntMsg
        const intMsgAddress = convertToIntMsg(walletAddress); // H√†m chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ n·∫øu c·∫ßn thi·∫øt

        // Hi·ªÉn th·ªã t√™n account ho·∫∑c ƒë·ªãa ch·ªâ IntMsg + link tonviewer
        const walletLink = document.getElementById('wallet-link');
        walletLink.href = `https://tonviewer.com/${intMsgAddress}`; // Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang ƒë·ªãa ch·ªâ IntMsg

        // C·∫≠p nh·∫≠t h√¨nh ·∫£nh v√≠
        const walletImage = document.getElementById('wallet-image');
        walletImage.src = '/logo-coin/wallet.png'; // ƒê·∫£m b·∫£o h√¨nh ·∫£nh v√≠ l√† /logo-coin/wallet.png

        // L·∫•y s·ªë d∆∞ TON
        const accountResponse = await fetch(`https://tonapi.io/v2/accounts/${walletAddress}`);
        const accountData = await accountResponse.json();

        const tonBalance = (accountData.balance / 1e9).toFixed(9);
        document.getElementById('wallet-balance').textContent = `${tonBalance} TON`;

        // L·∫•y gi√° TON t·ª´ CoinGecko
        const priceResponse = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=the-open-network&vs_currencies=usd');
        const priceData = await priceResponse.json();
        const tonPrice = priceData['the-open-network'].usd;

        // Quy ƒë·ªïi sang USDT
        const usdtValue = (tonBalance * tonPrice).toFixed(2);
        document.getElementById('wallet-usdt-value').textContent = `‚âà ${usdtValue} USDT`;

        document.getElementById('ton-balance').textContent = `${tonBalance} TON`;
        document.getElementById('ton-value').textContent = `$${usdtValue}`;

    } catch (error) {
        console.error("L·ªói khi l·∫•y d·ªØ li·ªáu:", error);
    }
}

// H√†m chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ v√≠ th√†nh d·∫°ng IntMsg
function convertToIntMsg(walletAddress) {
    // Logic chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ sang d·∫°ng IntMsg n·∫øu c·∫ßn thi·∫øt
    // V√≠ d·ª•: m√£ h√≥a ho·∫∑c chuy·ªÉn ƒë·ªïi ƒë·ªãa ch·ªâ v√≠ theo c√°ch n√†o ƒë√≥
    return walletAddress; // Thay th·∫ø b·∫±ng logic th·ª±c t·∫ø n·∫øu c·∫ßn
}

// Khi tr·∫°ng th√°i v√≠ thay ƒë·ªïi, c·∫≠p nh·∫≠t d·ªØ li·ªáu
tonConnectUI.onStatusChange(async (wallet) => {
    if (wallet) {
        fetchWalletData(wallet);
    }
});



// H√†m chuy·ªÉn h∆∞·ªõng ng∆∞·ªùi d√πng ƒë·∫øn ƒë∆∞·ªùng link g·ª≠i giao d·ªãch khi nh·∫•n n√∫t "Send"
function sendTransaction() {
    const assetCurrency = "TON";  // M√£ t√†i s·∫£n (TON)
    const assetAddress = "UQDu8vyZSZbAYvRRQ_jW4_0EiBGibAGq72wSZjYWRmNAGhRD";  // ƒê·ªãa ch·ªâ v√≠ c·ªßa b·∫°n, thay th·∫ø b·∫±ng ƒë·ªãa ch·ªâ v√≠ th·ª±c t·∫ø

    const url = `https://t.me/aliniex_bot/amp?startapp=tel_8xb3PN6dKJEXBWd`;
    window.location.href = url;  // Chuy·ªÉn h∆∞·ªõng ng∆∞·ªùi d√πng ƒë·∫øn URL
}
















// L·∫•y s·ªë d∆∞ BMC t·ª´ localStorage, tr√°nh m·∫•t d·ªØ li·ªáu khi s·ªë d∆∞ l·ªõn
let bmcBalance = Number(localStorage.getItem('bmcBalance')) || 0;  
const TON_VALUE_IN_USDT = 1;  // 1 TON = 1 USDT

// H√†m c·∫≠p nh·∫≠t s·ªë d∆∞ BMC v√† gi√° tr·ªã hi·ªÉn th·ªã
function getBMCBalance() {
    const balanceElement = document.getElementById("token-balance");
    const valueElement = document.getElementById("bmc-value");

    if (balanceElement) {
        balanceElement.innerText = `${bmcBalance.toLocaleString()} BMC`;
    }
    if (valueElement) {
        valueElement.innerText = `$${(bmcBalance * TON_VALUE_IN_USDT).toFixed(2)}`;
    }

    localStorage.setItem('bmcBalance', bmcBalance);
}

// H√†m hi·ªÉn th·ªã th√¥ng b√°o toast
function showToast(message) {
    const toast = document.getElementById('toast');
    if (!toast) return;

    const toastMessage = document.getElementById('toast-message');
    toastMessage.innerText = message;

    toast.classList.add('show');

    // X√≥a timeout c≈© n·∫øu c√≥
    clearTimeout(toast.timeout);
    toast.timeout = setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

// H√†m Mint BMC (Nh·∫≠n BMC sau khi giao d·ªãch th√†nh c√¥ng)
async function mintBMC() {
    try {
        const payload = "te6ccgEBAQEAAgAAAA==";  // Payload h·ª£p ƒë·ªìng

        const txParams = {
            validUntil: Math.floor(Date.now() / 1000) + 600,  // H·∫°n giao d·ªãch
            messages: [{
                address: "UQDu8vyZSZbAYvRRQ_jW4_0EiBGibAGq72wSZjYWRmNAGhRD",  
                amount: "1000000000",  // 1 TON (nanoTON)
                payload: payload
            }]
        };

        console.log("G·ª≠i giao d·ªãch:", txParams);
        await tonConnectUI.sendTransaction(txParams);  

        // Sau khi giao d·ªãch th√†nh c√¥ng, nh·∫≠n 100 BMC
        bmcBalance += 100;
        localStorage.setItem('bmcBalance', bmcBalance);
        getBMCBalance();
        showToast("Th√†nh c√¥ng!");
    } catch (error) {
        console.error("L·ªói khi g·ª≠i:", error);
        showToast("Th·∫•t b·∫°i");
    }
}
// L·∫•y s·ªë d∆∞ BMC khi trang ƒë∆∞·ª£c t·∫£i
document.addEventListener("DOMContentLoaded", getBMCBalance);




























// H√†m hi·ªÉn th·ªã th√¥ng b√°o "Coming Soon" v·ªõi hi·ªáu ·ª©ng Slide In
function showComingSoon() {
    var notification = document.getElementById('notification');
    
    // Hi·ªÉn th·ªã th√¥ng b√°o v√† di chuy·ªÉn v√†o v·ªã tr√≠
    notification.style.display = 'block';
    setTimeout(function() {
        notification.style.top = '20px'; // Hi·ªÉn th·ªã ·ªü v·ªã tr√≠ tr√™n c√πng
    }, 100);

    // ·∫®n th√¥ng b√°o sau 5 gi√¢y
    setTimeout(function() {
        notification.style.top = '-100px';  // Di chuy·ªÉn ra ngo√†i m√†n h√¨nh
        setTimeout(function() {
            notification.style.display = 'none';  // ·∫®n th√¥ng b√°o
        }, 500);
    }, 5000);  // Th·ªùi gian hi·ªÉn th·ªã 5 gi√¢y
}





// Hi·ªÉn th·ªã form r√∫t v√† c·∫≠p nh·∫≠t s·ªë d∆∞ kh·∫£ d·ª•ng
function showWithdrawForm() {
    document.getElementById("available-bmc").innerText = bmcBalance;
    document.getElementById("withdraw-form").style.display = "block";
}

// ƒê√≥ng form r√∫t
function closeWithdrawForm() {
    document.getElementById("withdraw-form").style.display = "none";
}

// C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng r√∫t theo thanh k√©o
function updateWithdrawAmount() {
    const sliderValue = parseInt(document.getElementById("withdraw-slider").value);
    const withdrawAmount = Math.floor((sliderValue / 100) * bmcBalance);
    document.getElementById("withdraw-amount").value = withdrawAmount;
}

// Khi click v√†o c√°c m·ª©c % tr√™n thanh k√©o
function setSliderValue(value) {
    let amount;
    if (value === "max") {
        amount = bmcBalance;
        document.getElementById("withdraw-slider").value = 100;
    } else {
        amount = Math.floor((value / 100) * bmcBalance);
        document.getElementById("withdraw-slider").value = value;
    }
    document.getElementById("withdraw-amount").value = amount;
}

// X·ª≠ l√Ω r√∫t BMC
async function withdrawBMC() {
    const address = document.getElementById("withdraw-address").value.trim();
    const amount = parseInt(document.getElementById("withdraw-amount").value);

    if (!address) {
        showToast("Please enter a valid wallet address!");
        return;
    }
    
    if (!amount || amount <= 0) {
        showToast("Please enter a valid amount!");
        return;
    }

    if (amount > bmcBalance) {
        showToast("Insufficient BMC balance!");
        return;
    }

    try {
        // Tr·ª´ s·ªë l∆∞·ª£ng ƒë√£ r√∫t
        bmcBalance -= amount;
        localStorage.setItem("bmcBalance", bmcBalance);
        getBMCBalance();

        showToast(`Successfully withdrawn ${amount} BMC!`);
        closeWithdrawForm();
    } catch (error) {
        console.error("Withdraw error:", error);
        showToast("Withdraw failed! Try again.");
    }
}












// C·∫≠p nh·∫≠t tr·∫°ng th√°i nhi·ªám v·ª• v√† th·ªùi gian ƒë·∫øm ng∆∞·ª£c
let checkInDone = JSON.parse(localStorage.getItem('checkInDone')) || false; // L·∫•y tr·∫°ng th√°i check-in
let nextCheckInTime = JSON.parse(localStorage.getItem('nextCheckInTime')) || getNextCheckInTime(); // L·∫•y th·ªùi gian check-in ti·∫øp theo

// C·∫≠p nh·∫≠t n√∫t Check-in v√† tr·∫°ng th√°i
updateCheckInButton();

// Ki·ªÉm tra tr·∫°ng th√°i v√† c·∫≠p nh·∫≠t n√∫t
document.getElementById('check-in-btn').addEventListener('click', function () {
    if (!checkInDone) {
        checkIn();
    } else {
        claimReward();
    }
});

function checkIn() {
    checkInDone = true;
    localStorage.setItem('checkInDone', JSON.stringify(checkInDone)); // L∆∞u tr·∫°ng th√°i check-in
    document.getElementById('check-in-btn').textContent = 'Claim';
    startCountdown();

    // C·ªông 100 BMC sau khi check-in th√†nh c√¥ng
    bmcBalance += 100;
    localStorage.setItem('bmcBalance', bmcBalance); // L∆∞u s·ªë d∆∞ BMC v√†o localStorage
    document.getElementById('bmc-balance').textContent = `S·ªë d∆∞ BMC: ${bmcBalance}`; // C·∫≠p nh·∫≠t hi·ªÉn th·ªã BMC
}

function claimReward() {
    document.getElementById('check-in-btn').disabled = true;
    document.getElementById('check-in-btn').textContent = 'Claimed';

    // C·∫≠p nh·∫≠t tr·∫°ng th√°i check-in ƒë√£ ho√†n th√†nh v√† l∆∞u v√†o localStorage
    checkInDone = false;
    localStorage.setItem('checkInDone', JSON.stringify(checkInDone));
}

function startCountdown() {
    const countdownElement = document.getElementById('countdown-timer');
    const interval = setInterval(function () {
        const remainingTime = getRemainingTime(nextCheckInTime);

        if (remainingTime <= 0) {
            clearInterval(interval);
            document.getElementById('check-in-btn').disabled = false;
            document.getElementById('check-in-btn').textContent = 'Check-in';
            nextCheckInTime = getNextCheckInTime(); // C·∫≠p nh·∫≠t th·ªùi gian check-in ti·∫øp theo
            localStorage.setItem('nextCheckInTime', JSON.stringify(nextCheckInTime)); // L∆∞u v√†o localStorage
            checkInDone = false;
            localStorage.setItem('checkInDone', JSON.stringify(checkInDone));
        } else {
            const hours = Math.floor(remainingTime / 3600);
            const minutes = Math.floor((remainingTime % 3600) / 60);
            const seconds = remainingTime % 60;
            countdownElement.textContent = `Th·ªùi gian ti·∫øp theo: ${hours}:${minutes < 10 ? '0' + minutes : minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
        }
    }, 1000);
}

// T√≠nh to√°n th·ªùi gian c√≤n l·∫°i ƒë·ªÉ check-in
function getRemainingTime(nextCheckInTime) {
    const now = new Date();
    const timeRemaining = nextCheckInTime - now;
    return timeRemaining / 1000; // Tr·∫£ v·ªÅ t√≠nh b·∫±ng gi√¢y
}

// L·∫•y th·ªùi gian check-in ti·∫øp theo (7 gi·ªù s√°ng mai)
function getNextCheckInTime() {
    const now = new Date();
    const nextCheckIn = new Date();
    nextCheckIn.setHours(7, 0, 0, 0); // Set 7:00 s√°ng
    if (now > nextCheckIn) {
        nextCheckIn.setDate(nextCheckIn.getDate() + 1); // N·∫øu ƒë√£ qua 7 gi·ªù s√°ng, th√¨ ƒë·∫∑t cho ng√†y h√¥m sau
    }
    return nextCheckIn;
}

function updateCheckInButton() {
    const checkInButton = document.getElementById('check-in-btn');
    if (checkInDone) {
        checkInButton.textContent = 'Claim'; // Hi·ªÉn th·ªã "Claim" khi ƒë√£ check-in
        checkInButton.disabled = false; // N√∫t "Claim" v·∫´n ho·∫°t ƒë·ªông
    } else {
        checkInButton.textContent = 'Check-in'; // Hi·ªÉn th·ªã "Check-in" khi ch∆∞a check-in
        checkInButton.disabled = true; // V√¥ hi·ªáu h√≥a n√∫t "Check-in" cho ƒë·∫øn khi l√†m m·ªõi nhi·ªám v·ª•
    }
}
 
</script>
</body>
</html>
